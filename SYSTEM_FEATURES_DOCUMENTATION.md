# 📚 견적서 관리 시스템 - 전체 기능 문서

> MotionSense 견적서 관리 시스템의 모든 메뉴와 기능을 상세히 문서화한 종합 매뉴얼

## 📋 목차
1. [시스템 개요](#시스템-개요)
2. [메인 네비게이션 메뉴](#메인-네비게이션-메뉴)
3. [상세 기능 분석](#상세-기능-분석)
4. [관리자 전용 기능](#관리자-전용-기능)
5. [API 엔드포인트](#api-엔드포인트)
6. [데이터베이스 구조](#데이터베이스-구조)

---

## 🎯 시스템 개요

### 핵심 특징
- **Next.js 14 App Router** 기반 모던 웹 애플리케이션
- **Supabase** 백엔드 (PostgreSQL + 실시간 기능)
- **Material-UI** 컴포넌트 라이브러리
- **TypeScript** 완전 지원
- **RLS (Row Level Security)** 기반 보안

### 사용자 역할
1. **Super Admin** - 전체 시스템 관리
2. **Admin** - 일반 관리 기능
3. **Member** - 일반 사용자
4. **User** - 제한된 권한 (하위 호환용)

---

## 🗂️ 메인 네비게이션 메뉴

### 1. 🏠 **대시보드** (`/dashboard`)
- **최근 활동 요약**
  - 최근 생성/수정된 견적서 목록
  - 대기 중인 승인 건수
  - 진행 중인 프로젝트 현황
- **통계 카드**
  - 이번 달 견적 총액
  - 진행 중인 프로젝트 수
  - 신규 고객 수
  - 대기 중인 알림 수
- **빠른 작업 버튼**
  - 새 견적서 작성
  - 프로젝트 관리
  - 고객 목록 보기

### 2. 📝 **견적서** (`/quotes`)
#### 2.1 견적서 목록 (`/quotes`)
- **필터링 기능**
  - 상태별 (초안/제출/승인/거절)
  - 고객사별
  - 날짜 범위
  - 프로젝트명 검색
- **정렬 기능**
  - 최신순/오래된순
  - 금액순
  - 고객사명순
- **대량 작업**
  - 다중 선택 삭제
  - 상태 일괄 변경
  - Excel 내보내기

#### 2.2 새 견적서 작성 (`/quotes/new`)
- **프로젝트 정보 입력**
  - 프로젝트명
  - 고객사 선택 (자동완성)
  - 발행일자
  - 유효기간
- **3단계 견적 구조**
  - **그룹 관리**
    - 그룹 추가/삭제/이름 변경
    - 대행수수료 적용 여부 설정
  - **항목 관리**
    - 항목 추가/삭제/이름 변경
    - 대행수수료 상속/개별 설정
  - **세부내용 관리**
    - 품목명, 설명
    - 수량, 일수, 단위
    - 단가, 금액 자동 계산
    - 서비스/물품 구분
- **마스터 품목 연동**
  - 품목 라이브러리에서 선택
  - 자주 사용하는 품목 즐겨찾기
  - 카테고리별 분류
- **템플릿 시스템**
  - 템플릿 선택 및 적용
  - 현재 견적서를 템플릿으로 저장
- **원가 관리** (선택적 표시)
  - 공급업체 선택
  - 원가 입력
  - 실시간 수익률 계산
  - 마진 분석
- **부가세 설정**
  - 별도/포함 선택
  - VAT 자동 계산
- **할인 설정**
  - 할인 금액 입력
  - 최종 금액 자동 재계산
- **대행수수료 설정**
  - 수수료율 조정 (0~30%)
  - 그룹/항목별 적용 설정
  - 수수료 내역 상세 표시
- **자동 저장**
  - 30초마다 자동 임시저장
  - 페이지 이탈 방지 경고
  - 복구 기능
- **PDF 생성 및 다운로드**
  - 원가 포함/제외 선택
  - 워터마크 추가
  - 전자 서명 삽입

#### 2.3 견적서 상세/수정 (`/quotes/[id]`, `/quotes/[id]/edit`)
- **버전 관리**
  - 수정 이력 확인
  - 이전 버전 복원
  - 버전 비교
- **상태 변경**
  - 초안 → 제출 → 승인/거절
  - 상태 변경 알림 발송
- **프로젝트 전환**
  - 승인된 견적서를 프로젝트로 자동 생성
  - 관련 데이터 자동 이관
- **복사 기능**
  - 기존 견적서 복제
  - 유사 프로젝트 빠른 생성
- **공유 기능**
  - 고객용 읽기 전용 링크 생성
  - 이메일 전송
  - 공유 기한 설정

### 3. 📁 **프로젝트** (`/projects`)
#### 3.1 프로젝트 목록 (`/projects`)
- **칸반 보드 뷰**
  - 준비/진행중/완료/보류 상태
  - 드래그 앤 드롭 상태 변경
- **리스트 뷰**
  - 테이블 형식 표시
  - 상세 필터링
- **프로젝트 통계**
  - 진행률 표시
  - 예산 대비 실행률
  - 마감일 D-Day

#### 3.2 프로젝트 상세 (`/projects/[id]`)
- **프로젝트 정보**
  - 기본 정보 수정
  - 담당자 지정
  - 일정 관리
- **거래 내역 관리**
  - 수입/지출 내역 등록
  - 세금계산서 상태 관리
  - 정산 상태 추적
- **관련 문서**
  - 견적서 연결
  - 계약서 업로드
  - 보고서 첨부
- **프로젝트 타임라인**
  - 주요 이벤트 기록
  - 변경 사항 추적
  - 코멘트 작성

### 4. 💰 **매출 관리** (`/revenue`)
#### 4.1 칸반 보드 뷰 (`/revenue`)
- **4단계 정산 상태**
  - 대기 (노란색)
  - 진행중 (파란색)
  - 완료 (초록색)
  - 이슈 (빨간색)
- **드래그 앤 드롭**
  - 상태 간 이동
  - 실시간 업데이트
- **정산 카드 정보**
  - 프로젝트명
  - 거래처
  - 금액 (수입/지출)
  - D-Day 표시
  - 세금계산서 상태
  - 긴급 알림 (기한 초과/임박)
- **컬럼별 집계**
  - 총액 표시
  - 건수 배지

#### 4.2 대시보드 뷰
- **월별 매출 현황**
  - 수입/지출 그래프
  - 순이익 추이
  - 전년 대비 비교
- **프로젝트별 수익성**
  - 수익률 랭킹
  - 손익 분석
- **거래처별 매출**
  - 주요 고객 분석
  - 매출 비중

#### 4.3 정산 관리 기능
- **새 정산 추가**
  - 수입/지출 구분
  - 프로젝트 연결
  - 거래처 정보
  - 마감일 설정
- **정산 편집**
  - 정보 수정
  - 메모 작성
  - 첨부파일 관리
- **일괄 작업**
  - 다중 선택
  - 상태 일괄 변경
  - Excel 내보내기

### 5. 👥 **고객사** (`/customers`)
- **고객사 목록**
  - 검색 및 필터링
  - 사업자번호 조회
  - 최근 거래 표시
- **고객사 추가/수정**
  - 회사 정보 (상호, 대표자, 업태/종목)
  - 연락처 정보 (담당자, 전화, 이메일)
  - 사업자 정보 (사업자번호, 주소)
  - 거래 조건 (결제 조건, 할인율)
- **고객사별 거래 내역**
  - 견적서 이력
  - 프로젝트 목록
  - 매출 통계
- **고객 관계 관리**
  - 미팅 기록
  - 특이사항 메모
  - 선호 사항

### 6. 📦 **품목 관리** (`/items`)
#### 6.1 마스터 품목 라이브러리
- **카테고리 관리**
  - 영상제작 (촬영, 편집, 그래픽)
  - 행사운영 (장비, 인력, 장소)
  - 기타 서비스
- **품목 등록/수정**
  - 품목명, 설명
  - 기본 단위, 단가
  - 서비스/물품 구분
  - 사용 빈도 통계
- **즐겨찾기 관리**
  - 자주 사용하는 품목 등록
  - 빠른 접근
- **가격 이력 관리**
  - 단가 변경 이력
  - 시즌별 가격 설정

#### 6.2 공급업체 관리 (`/suppliers`)
- **공급업체 목록**
  - 업체명, 담당자
  - 연락처, 이메일
  - 거래 품목
  - 활성/비활성 상태
- **공급업체 등록/수정**
  - 기본 정보
  - 거래 조건
  - 주요 품목 및 단가
- **거래 이력**
  - 발주 내역
  - 결제 현황
  - 평가 및 메모

### 7. 🔔 **알림** (`/notifications`)
#### 7.1 알림 센터 (`/notifications`)
- **알림 유형**
  - 견적서 상태 변경
  - 프로젝트 마감 임박
  - 정산 기한 알림
  - 시스템 공지
- **알림 관리**
  - 읽음/안읽음 표시
  - 중요 알림 고정
  - 일괄 읽음 처리
  - 알림 삭제

#### 7.2 알림 설정 (`/notifications/settings`)
- **알림 수신 설정**
  - 이메일 알림 ON/OFF
  - 알림 유형별 설정
  - 알림 시간대 설정
- **알림 규칙**
  - 커스텀 알림 규칙 생성
  - 조건부 알림 설정

### 8. ⚙️ **관리자** (`/admin`)
#### 8.1 사용자 관리 (`/admin/users`)
- **사용자 목록**
  - 이름, 이메일, 역할
  - 활성/비활성 상태
  - 마지막 로그인
- **사용자 추가/수정**
  - 기본 정보 입력
  - 역할 지정 (Super Admin/Admin/Member)
  - 권한 설정
- **초대 기능**
  - 이메일 초대 발송
  - 임시 비밀번호 생성
  - 초대 링크 관리
- **접근 권한 관리**
  - 메뉴별 접근 권한
  - 데이터 접근 범위
  - 기능 사용 제한

#### 8.2 시스템 설정 (`/admin/settings`)
- **회사 정보 설정**
  - 회사명, 대표자
  - 사업자 정보
  - 로고 업로드
- **견적서 설정**
  - 기본 대행수수료율
  - VAT 설정
  - 견적서 번호 형식
  - PDF 템플릿 커스터마이징
- **알림 설정**
  - 시스템 전체 알림 규칙
  - 이메일 템플릿
  - 알림 주기
- **백업 설정**
  - 자동 백업 주기
  - 백업 보관 기간
  - 수동 백업 실행

---

## 🔌 API 엔드포인트

### 인증 관련
- `POST /api/auth/login` - 로그인
- `POST /api/auth/logout` - 로그아웃
- `GET /api/auth/session` - 세션 확인

### 견적서 관련
- `GET /api/quotes` - 견적서 목록
- `POST /api/quotes` - 견적서 생성
- `GET /api/quotes/[id]` - 견적서 상세
- `PATCH /api/quotes/[id]` - 견적서 수정
- `DELETE /api/quotes/[id]` - 견적서 삭제
- `POST /api/quotes/[id]/pdf` - PDF 생성
- `POST /api/quotes/[id]/copy` - 견적서 복사
- `POST /api/quotes/[id]/convert-to-project` - 프로젝트 전환

### MotionSense 전용
- `POST /api/motionsense-quotes` - 스냅샷 포함 견적서 생성
- `GET /api/motionsense-quotes/[id]` - 스냅샷 견적서 조회
- `GET /api/motionsense-quotes/[id]/pdf` - PDF 생성

### 프로젝트 관련
- `GET /api/projects` - 프로젝트 목록
- `POST /api/projects` - 프로젝트 생성
- `GET /api/projects/[id]` - 프로젝트 상세
- `PATCH /api/projects/[id]` - 프로젝트 수정

### 거래 관련
- `GET /api/transactions` - 거래 목록
- `POST /api/transactions` - 거래 생성
- `PATCH /api/transactions/[id]` - 거래 수정
- `DELETE /api/transactions/[id]` - 거래 삭제

### 고객사 관련
- `GET /api/customers` - 고객사 목록
- `POST /api/customers` - 고객사 등록
- `PATCH /api/customers/[id]` - 고객사 수정

### 품목 관련
- `GET /api/master-items` - 마스터 품목 목록
- `POST /api/master-items` - 품목 등록
- `GET /api/quote-templates` - 템플릿 목록
- `POST /api/quote-templates` - 템플릿 생성

### 공급업체 관련
- `GET /api/suppliers` - 공급업체 목록
- `POST /api/suppliers` - 공급업체 등록

### 알림 관련
- `GET /api/notifications` - 알림 목록
- `PATCH /api/notifications/[id]` - 알림 읽음 처리
- `POST /api/notifications/mark-all-read` - 모두 읽음
- `GET /api/notifications/settings` - 알림 설정

### 관리자 관련
- `GET /api/admin/users` - 사용자 목록
- `POST /api/admin/users` - 사용자 생성
- `POST /api/admin/users/invite` - 사용자 초대
- `GET /api/admin/settings` - 시스템 설정
- `PATCH /api/admin/settings` - 설정 변경

---

## 💾 데이터베이스 구조

### 핵심 테이블
1. **quotes** - 견적서 마스터
2. **quote_groups** - 견적서 그룹
3. **quote_items** - 견적서 항목
4. **quote_details** - 견적서 세부내용 (스냅샷)
5. **projects** - 프로젝트
6. **transactions** - 거래 내역
7. **customers** - 고객사
8. **master_items** - 마스터 품목
9. **quote_templates** - 견적서 템플릿
10. **suppliers** - 공급업체
11. **profiles** - 사용자 프로필
12. **notifications** - 알림

### 주요 특징
- **스냅샷 기반 데이터 저장** - 견적서 생성 시점의 데이터 보존
- **RLS (Row Level Security)** - 사용자별 데이터 접근 제어
- **자동 트리거** - 견적서 번호 자동 생성, 업데이트 시간 자동 기록
- **관계형 무결성** - 외래 키 제약 조건

---

## 🎨 UI/UX 특징

### 디자인 시스템
- **글래스모피즘** - 현대적인 반투명 효과
- **평면적 디자인** - 그림자 없는 깔끔한 인터페이스
- **반응형 레이아웃** - 모바일/태블릿/데스크톱 지원
- **다크/라이트 모드** - 사용자 선호도 대응

### 사용성 기능
- **자동 저장** - 데이터 손실 방지
- **페이지 이탈 경고** - 저장하지 않은 변경사항 보호
- **실시간 계산** - 금액 자동 계산
- **드래그 앤 드롭** - 직관적인 상태 변경
- **자동 완성** - 고객사, 품목 빠른 입력
- **키보드 단축키** - 효율적인 작업

### 접근성
- **ARIA 레이블** - 스크린 리더 지원
- **키보드 네비게이션** - 마우스 없이 조작 가능
- **고대비 모드** - 시각 장애인 지원
- **폰트 크기 조절** - 가독성 향상

---

## 📊 통계 및 리포트

### 대시보드 통계
- 월별 매출/지출 현황
- 프로젝트 진행 상태
- 고객사별 매출 비중
- 수익률 분석

### 리포트 기능
- Excel 내보내기
- PDF 리포트 생성
- 커스텀 리포트 작성
- 정기 리포트 스케줄링

---

## 🔒 보안 기능

### 인증 및 권한
- **이메일 도메인 검증** - @motionsense.co.kr 전용
- **역할 기반 접근 제어** (RBAC)
- **세션 관리** - 자동 로그아웃
- **2단계 인증** (향후 구현 예정)

### 데이터 보안
- **RLS (Row Level Security)** - 데이터 격리
- **암호화** - 민감 정보 암호화
- **감사 로그** - 모든 활동 기록
- **백업** - 정기 백업 및 복원

---

## 🚀 향후 확장 계획 (Phase 2/3)

### 고급 분석 시스템 (2%)
- 월별/연간 수익성 분석 대시보드
- 고객사별 매출 비중 차트
- 프로젝트 수익률 트렌드 분석
- 엑셀 데이터 내보내기 기능

### 정산 관리 시스템 (2%)
- 칸반 보드 형태의 정산 관리
- 수금/지급 일정 관리
- 세금계산서 발행 상태 추적
- 프로젝트 기타 경비 관리

### 알림 시스템 자동화 (1%)
- 정산일 임박 알림
- 프로젝트 상태 변경 알림
- 시스템 내 알림 센터
- 이메일 연동 알림

---

이 문서는 MotionSense 견적서 관리 시스템의 **모든 기능을 포괄적으로** 다루고 있으며, 시스템의 **현재 구현 상태(82%)**를 반영합니다.